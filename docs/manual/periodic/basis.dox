/*! \page prdc_basis_page Symmetry-Adapted Fourier Bases

\ref prdc_symmetry_page  (Prev) &nbsp; &nbsp; &nbsp; &nbsp;
\ref developer_page  (Next)
<BR>

PSCF allows users to input and output chemical potential and monomer
concentration fields using an expansion in basis functions in which
each basis function is an eigenfunction of the Laplacian that is
invariant under all symmetry operations of a specified space group.
We refer to the resulting basis as a symmetry-adapted Fourier basis,
and the expansion as a symmetry-adapted Fourier series. This page
discusses the mathematics underlying the construction of such a basis.
The discussion of symmetry-adapted basis functions given here uses 
concepts and notation introduced in a separate appendix about
\ref prdc_symmetry_page "crystal symmetry", which should be read 
before this page.

The discussion given here uses a notation appropriate to periodic 
fields that are continuous functions of position within a 
D-dimensional vector space. We discuss below how all of the main 
results can also be interpreted so as to apply to symmetry-adapted 
basis functions that are defined on the nodes of a regular mesh, 
subject to a few restrictions that we discuss.

\section prdc_basis_mesh_sec Continuous vs. discretized functions

Numerical computations in the PSCF programs for periodic systems are
performed using periodic fields that are actually defined only at
positions corresponding to the the nodes of a regular computational
mesh. Fourier amplitudes for such discretized functions are defined
by discrete Fourier transforms.

For simplicity, the discussion given here is presented using a notation
that is appropriate to fields that are continuous functions of position
in a D-dimensional space. All of the concepts, definitions and theorems
presented here, however, can be shown to be equally applicable to
functions that are defined only on the nodes of a regular mesh if the
following assumptions and constraints are understood to apply:

   - The mesh on which functions are defined must be invariant
     under all elements of the space group of interest, in the
     sense defined \ref prdc_symmetry_invariant_def "here". This
     is necessary to allow us to unambigously define the effect
     of crystal symmetry operations upon a discretized function.

   - Values of functions of position must be understood to only be
     defined for positions that lie on nodes of the mesh. In this
     context, any statement that some condition is satisfied for
     *all* values of a position \f$ {\bf r} \f$ must be understood
     to mean that it is satisfied for all nodes of the mesh. For
     example, we define a real field for this purpose to be a field
     that has real values at all nodes of the mesh.

   - Plane waves and Fourier amplitudes must be understood to be
     defined using discrete Fourier transforms.

   - Wavevectors that are aliases of one another must be understood
     to be equal, i.e., to be different ways of representing the
     same quantity, and to thus satisfy an equality in any equation.
     This is equivalent to saying that each integer component of
     a crystal wavevector in a reciprocal basis is defined only
     modulo the number of grid points along the associated direction.
     When the wavevectors are said to be "distinct" or "inequivalent",
     this must be understood to imply in this context that they are 
     not aliases of one another.

   - The norm \f$ |{\bf G} |\f$ of a reciprocal lattice wavevector
     \f$ {\bf G} \f$, when needed, is defined to be the norm of
     a \ref prdc_fourier_minindex_sub "minimal image" of
     \f$ {\bf G} \f$, i.e., the norm of an alias with integer 
     components chosen so as to minimize the usual definition of the 
     norm as \f$ |{\bf G}| = \sqrt{{\bf G}\cdot{\bf G}} \f$.

   - Some expressions that involve an integral over a unit cell of
     a crystal, e.g., to define orthogonality, must be replaced by
     analogous expressions that involve a sum over all nodes of
     of the mesh used to represent a single unit cell.

If interpreted using these assumptions and constraints, all of the
definitions and theorems presented in this appendix can be applied to 
periodic functions that are defined on the nodes of an appropriate
mesh, as well as for continuous periodic functions.

The requirement that the computational mesh be invariant under all
elements of the relevant space group imposes constraints on allowed 
choices for the dimensions of the mesh (i.e., the number of grid points 
along each direction) used to describe a structure with a known 
symmetry.  As a simple example, this requirement implies that one must 
use equal numbers of grid points along the three orthogonal direction 
of a mesh used to simulate a cubic crystal.  The existence of symmetry 
operations that involve translations by fractions of a unit cell imposes 
other constraints that can require the number of grid points along some
directions to be multiples of some small integer. For example, a mesh 
for a BCC crystal must use equal even numbers of grid points in all 
directions in order to correctly represent operations that map the 
origin to the body-centered point.  These constraints on mesh dimensions 
are discussed in somewhat more detail \ref prdc_symmetry_invariant_def 
"here".

The algorithm that PSCF uses to construct symmetry-adapted basis functions
will fail if the parameter file contains a list of mesh dimensions and a 
space group identifier that are incompatible, because the mesh would not 
be invariant under all operations of the chosen space group.
If the mesh dimensions and space group are found to be incompatible, the 
pscf_pc and pscf_pg programs will write a message to the log file that 
explains the nature of the error, and then halt execution. 

\section prdc_basis_star_sec Wavevector stars

The first step in the algorithm used by PSCF to construct symmetry
adapted basis functions is to partition the set of all distinct
reciprocal lattice vectors used in the Fourier expansion of periodic
functions into non-intersecting subsets of wavevectors that are
related to one another by symmetry group operation. We refer to each
each such set of symmetry-related wavevectors as a star.

Two simple examples may help illustrate the idea:

   - In a 1D crystal with inversion symmetry (a centrosymmetric lamellar
     phase), any two nonzero, distinct wavevectors \f$ {\bf G} \f$ and
     \f$ -{\bf G} \f$ are related by inversion symmetry and thus form a
     star containing these two wavevectors.

   - In a 3D cubic crystal, all of the wavevectors with Miller indices
     that are related to a particular set of non-negative integers
     \f$ \{hkl\} \f$ by changes in sign of one or more indices and/or
     permutations are related by symmetry elements of a cubic crystal.
     The number of wavevectors in such a star is always equal to or
     less than 48 if the integers i, j, and k are all nonzero and
     unequal, and is less than 48 if any of the integers h, k, and l
     are equal to zero or if any pair of these integers are equal.

Wavevectors in a star are always related by point group operations
associated with elements of the space group. Because point group operations
are always orthogonal transformations, wavevectors in the same star are
always vectors of equal norm. When this statement is applied to
wavevectors used to describe functions that are defined on a mesh,
the norm must be understood to be the norm of a minimal image of each
wavevector.

\anchor prdc_basis_star_defn
<b> Definition (Star) </b>: A <em>star</em> star \f$ T \f$ of a space
group \f$ S \f$ is a set of distinct reciprocal lattice vectors with
the following two properties:

   - Closure under \f$ S \f$: For each wavevector \f${\bf G} \in T\f$
     and each symmetry operation \f$ A \in S\f$, \f$ {\bf G}A \in T \f$.

   - Connectivity: For each pair of wavevectors \f$ {\bf G} \f$ and
     \f$ {\bf G}' \f$ in \f$ T \f$, there exists a symmetry operation
     \f$ A \in S \f$ such that \f$ {\bf G}' = {\bf G} A \f$.

Comment: If two wavevectors \f$ {\bf G} \f$ and \f$ {\bf G}'\f$ are
related by any sequence of symmetry operations in \f$ S \f$, then
\f$ {\bf G} \f$ and \f$ {\bf G}' \f$ are also related by a single
symmetry operation in \f$ S \f$ that is given by the product of the
operations in that sequence. The requirement that any two wavevectors
in a star be related by a single symmetry operation is thus completely
equivalent to a requirement that they be related by some sequence of
symmetry operations.

\anchor prdc_basis_star_intersect_thrm
<b> Theorem D.1 (Intersecting stars are equal) </b>:
If \f$ T \f$ and \f$ T' \f$ are both star functions of a space group
\f$ S \f$ with \f$ T \cap T' \neq \emptyset \f$, then \f$ T = T' \f$.

<em> Proof </em>: Suppose that \f$ T \cap T' \neq 0 \f$. Suppose that
\f$ {\bf G} \f$ and \f$ {\bf G}'\f$ are wavevectors such that
\f$ {\bf G} \in T \cap T' \f$ and \f$ {\bf G}' \in T' \f$.  Because
both \f$ {\bf G} \f$ and \f$ {\bf G}' \f$ are in \f$ T' \f$, there must
exist \f$ A \in S \f$ such that \f$ {\bf G}' = {\bf G}A \f$.  Because
\f$ T \f$ is closed under multiplication by elements of \f$ S \f$,
this implies that \f$ {\bf G}' \in T \f$, or that every vector in
\f$ T' \f$ is also in \f$ T \f$, or \f$ T' \subseteq T \f$. By
reversing the roles of \f$ T \f$ and \f$ T' \f$, by assuming that
\f$ {\bf G} \in T \cap T' \f$ and \f$ {\bf G}' \in T \f$, we may also
show by analogous arguments that \f$ T \subseteq T' \f$, and thus that
\f$ T = T' \f$.

\ref prdc_basis_star_intersect_thrm "Theorem D.1" is logically equivalent
to the statement that unequal stars must have an empty intersection.
It also implies that a star cannot be proper subset of another star.

\anchor prdc_basis_star_generate_thrm
<b> Theorem D.2 (Generating a star from a wavevector) </b>:
Suppose that \f$ {\bf G}_{0} \f$ is a reciprocal lattice wavevector,
and \f$ S \f$ is a space group. Let \f$ Q \f$ be the set of all
wavevectors such that for each \f$ {\bf G} \in Q \f$ there exists
\f$ A \in S \f$ such that \f$ {\bf G} = {\bf G}_{0}A \f$. Set
\f$ Q \f$ is a star of \f$ S \f$ that contains \f$ {\bf G}_{0} \f$.

<em> Proof </em>:
Because \f$ S \f$ must contain the identity element \f$ E \f$,
and \f$ {\bf G}_{0} = {\bf G}_{0}E \f$, \f$ Q \f$ must contain
\f$ {\bf G}_{0} \f$.
To prove that \f$ Q \f$ is a star, we must prove closure under
\f$ S \f$ and connectivity, as defined in the above definition
of a \ref prdc_basis_star_defn "star".

Proving closure: Suppose \f$ {\bf G} \f$ is a wavector in
\f$ Q \f$ and that \f$ A \f$ and \f$ B \f$ are elements of
\f$ S \f$, such that \f$ {\bf G} = {\bf G}_{0} A \f$.  Let
\f$ {\bf G}' = {\bf G}B  = {\bf G}_{0}(AB) \f$. Observe that
\f$ AB \in S \f$, because \f$ S \f$ is closed under
multiplication. This implies that \f$ {\bf G}B \in Q \f$ for
any \f$ {\bf G} \in Q \f$ and \f$ B \in S \f$, proving that
\f$ Q \f$ is closed under \f$ S \f$.

Proving connectivity: Consider \f$ {\bf G}, {\bf G} '\in Q\f$,
for which there exist \f$ A, B \in S \f$ such that
\f$ {\bf G} = {\bf G}_{0}A \f$ and
\f$ {\bf G}' = {\bf G}_{0}B \f$.
Observe that \f$ {\bf G}' = {\bf G}C \f$ where
\f$ C = A^{-1}B \f$, and that \f$ C \in S \f$.

\anchor prdc_basis_star_unique_thrm
<b> Theorem D.3 (Every wavevector belongs to a unique star) </b>:
If \f$ {\bf G} \f$ is a reciprocal lattice wavevector and
\f$ S \f$ is a space group, then \f$ {\bf G} \f$ belongs to
exactly one star of \f$ S \f$.

<em> Proof </em>:
Let \f$ T \f$ denote the set that is generated by applying all
the elements of \f$ S \f$ to \f$ {\bf G} \f$.
By \ref prdc_basis_star_generate_thrm "theorem D.2", \f$ T \f$
is a star of \f$ S \f$ that contains \f${\bf G} \f$.
Suppose \f$ T' \f$ is also a star of \f$ S \f$ such that
\f$ {\bf G} \in T' \f$.
This implies \f$ T \cap T' \neq \emptyset \f$ and thus, by
\ref prdc_basis_star_intersect_thrm "theorem D.1" , that
\f$ T = T' \f$.

\section prdc_basis_star_functions_sec Star functions

A star function is a linear superposition of waves with wavevectors
in a star with coefficients chosen such that the superposition is
symmetric under the space group.

\anchor prdc_basis_starfunc_def
<b> Definition (Star Function) </b>:
Suppose \f$ T \f$ is a star of a space group \f$ S \f$ that contains
\f$ M \f$ wavevectors, such that
\f$ T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \f$.
A <em>star function</em> associated with \f$ T \f$ is defined to be
a nonzero function \f$ \phi({\bf r}) \f$ that is symmetric under
\f$ S \f$ and that is equal to a superposition
\anchor prdc_basis_starfunc_eqn
\f[
   \phi(\textbf{r}) =
   \sum_{j=0}^{M-1} c_{j} e^{i\textbf{G}_{j} \cdot \textbf{r}}
\f]
of waves with wavevectors in \f$ T \f$, with complex coefficients
\f$ c_{0}, \ldots, c_{M-1} \f$. The constant \f$ c_{j} \f$ in such
a sum is referred to as the coefficient associated wtih wavevector
\f$ {\bf G}_{j} \f$.

Some properties of star functions follow immediately from the their
definitions as superpositions of waves with wavevectors that belong
to a star.

<b> Theorem D.4 (Star functions are eigenfunctions of the Laplacian )</b>:
Every star function \f$ \phi({\bf r}) \f$ associated with a star \f$ T \f$
of a space group \f$ S \f$ satisfies an eigenfunction equation
\f[
   -\nabla^{2}\phi({\bf r}) = \lambda\phi({\bf r})
\f]
in which the eigenvalue \f$\lambda\f$ is equal to the square magnitude
of any of wavevectors in star \f$ T \f$.

<em> Proof: </em> Each star function is a superposition of waves with
wavevectors that are related by unitary point group operations, and
are thus wavevectors of equal magnitude. Because these waves are all
thus eigenfunctions of the Laplacian with equal eigenvalues, any
superposition of these waves is also an eigenfunction of the Laplacian
with the same eigenvalue.

<b> Theorem D.5 (Star functions of different stars are orthogonal ) </b>:
If \f$ f({\bf r}) \f$ and \f$ g({\bf r}) \f$ are star functions
associated with different stars of the same space group, then they are
orthogonal, in the sense that
\f[
    \int d^{D}r \; f^{*}({\bf r}) g({\bf r}) = 0 \quad,
\f]
where the integral is taken over one unit cell of the lattice.
An analogous statement holds for functions that are defined on the
nodes of a regular mesh, with orthogonality defined by the vanishing
of a sum over nodes of one unit cell of the mesh, rather than an
integral.

<em> Proof </em>: Orthogonality of star functions follows from the
fact that waves with different wavevectors are orthogonal in the same
sense, and that the intersection of different stars is an empty set.
Orthogonality is defined using an integral over one unit cell for
periodic functions, as in the theorem statement, and using an analogous
sum over nodes of the mesh for functions that are defined on a mesh.

The relationship among coefficients in this expansion of a star
function may be determined by requiring that the function be symmetric
under the specified space group.

\anchor prdc_basis_starfunc_phase_thrm
<b> Theorem D.6 (Relationships among coefficients in a star function) </b>:
Suppose that \f$ \phi({\bf r}) \f$ is a star function associated with a
star \f$ T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \f$ of space group
\f$ S \f$ that contains \f$ M \f$ wavevectors.
Suppose \f$ {\bf G}_{j} \f$  and \f$ {\bf G}_{k} \f$ are wavevectors in
\f$ T \f$ and that \f$ A = (R, {\bf t}) \f$ is a symmetry operation
in \f$ S \f$, for which
\f[
   {\bf G}_{k} = {\bf G}_{j}A \quad.
\f]
The coefficients for the waves associated with wavevectors
\f$ {\bf G}_{j} \f$ and \f$ {\bf G}_{k} \f$ must satisfy
\anchor prdc_basis_phase_eqn
\f[
   c_{k} = c_{j} e^{ i{\bf G}_{j}\cdot{\bf t} } \quad.
\f]
where \f$ c_{j} \f$ denotes the coefficient of the wave with wavevector
\f$ {\bf G}_{j} \f$ in the superposition of the form given in the above
\ref prdc_basis_starfunc_def "definition of a star function".

<em>Proof</em>:
Suppose that
\f[
   \phi(\textbf{r}) =
   \sum_{j=1}^{M} c_{j} e^{i\textbf{G}_{j} \cdot \textbf{r}}
\f]
is a star function associated with star \f$ T \f$ of a space group that
\f$ S \f$ that contains a symmetry element \f$ A = (R,{\bf t}) \f$.
The transformed star function \f$ \phi A \f$ can be expressed as a
superposition
\f[
   \phi(A({\bf r})) =
   \phi( R{\bf r} + {\bf t} ) = \sum_{j=0}^{M-1} c_{j}
   e^{ i\textbf{G}_{j}R \cdot \textbf{r}}
   e^{i{\bf G}_{j} \cdot {\bf t}}
   \quad.
\f]
The equation relating \f$ c_{j} \f$ and \f$ c_{k} \f$ follows from the
requirement that coefficients of corresponding waves be equal in the
expansions of \f$ \phi \f$ and \f$ \phi A \f$.

<b> Corollary: </b> The relationships among coefficients obtained
in \ref prdc_basis_starfunc_phase_thrm "Theorem D.6" imply that the
coefficients associated with different waves in a star function must
all have equal absolute magnitude,
\f[
    |c_{1}| = |c_{2}| = \cdots |c_{M}| \quad.
\f]

\anchor prdc_basis_phaserel_def
<b> Definition (Phase relationship) </b>:
The equation relating the coefficients of two waves within a star given
in \ref prdc_basis_starfunc_phase_thrm "Theorem D.6" is referred to here
as a <em> phase relationship </em> between these waves, or between the
associated wavevectors.

\anchor prdc_basis_phasefactor_def
<b> Definition (Phase factor) </b>:
The quantity
\f[
    e^{i{\bf G}\cdot {\bf t}}
\f]
is referred to as the phase factor generated by applying a symmetry
operator \f$ A = (R,{\bf t}) \f$ to wavevector \f$ {\bf G} \f$, while
\f$ {\bf G}\cdot {\bf t} \f$ is the corresponding phase change.

<b> Theorem D.7 (Multiplication rule for phase factors) </b>:
Suppose \f$ {\bf G} \f$, \f$ {\bf G}' \f$ and \f$ {\bf G}''\f$ are
wavevectors in the same star of a space group \f$ S \f$, and are
related by symmetry operations \f$ A, B, C \in S\f$ such that
\f$ C = AB \f$ and
\f[
    {\bf G}' = {\bf G}A  \quad, \quad
    {\bf G}'' = {\bf G}'B = {\bf G}C
\f]
where
\f$ A = (R_{A}, {\bf t}_{A}) \f$,
\f$ B = (R_{B}, {\bf t}_{B}) \f$,
and \f$ C = AB = (R_{C}, {\bf t}_{C}) \f$.
The phase factor generated by applying \f$ C \f$ to \f$ {\bf G} \f$ is
given by the product
\f[
  e^{i{\bf G}\cdot {\bf t}_{C}}
  = e^{i{\bf G} \cdot {\bf t}_{A}}
    e^{i{\bf G}'\cdot {\bf t}_{B}}
  \quad,
\f]
of the phase factor \f$e^{i {\bf G}\cdot{\bf t}_{A}} \f$ generated
by applying \f$ A \f$ to \f$ {\bf G} \f$ and
the factor \f$ e^{i {\bf G}'\cdot{\bf t}_{B}} \f$ generated by applying
\f$ B \f$ to \f$ {\bf G}' \f$.

<em>Proof</em>: Recall that, for \f$ C = AB \f$,
\f$ R_{C} =  R_{A}R_{B} \f$ and 
\f$ {\bf t}_{C} = {\bf t}_{A} + R_{A}{\bf t}_{B} \f$. 
Using the fact that \f$ {\bf G}A = R_{A}^{\dagger}{\bf G} \f$, where 
\f$ R_{A}^{\dagger} \f$ is the \ref prdc_symmetry_adjoint_def_eqn 
"adjoint" of \f$ R_{A} \f$, observe that
\f[
   {\bf G}'\cdot {\bf t}_{B}
   = (R_{A}^{\dagger}{\bf G}) \cdot {\bf t}_{B}
   = {\bf G}\cdot R_{A} {\bf t}_{B} \quad.
\f]
Combining these relationships yields
\f[
  {\bf G}\cdot {\bf t}_{C}
  = {\bf G} \cdot ( {\bf t}_{A} + R_{A} {\bf t}_{B} )
  = {\bf G} \cdot {\bf t}_{A} + {\bf G}'\cdot {\bf t}_{B}
  \quad.
\f]
This additive relationship of phase changes yields a
multiplicative relationship for phase factors.

\subsection prdc_basis_cancel_sub Cancelled stars

The set of phase relationships among waves in a star of \f$ M \f$
wavevectors is a homogeneous system of linear equations for the
coefficients \f$ c_{1}, \ldots, c_{M} \f$.  This system of equations
always has a trivial solution in which all of the coefficients are zero.
For some stars of some space groups, this trivial solution is the only
one.

<b> Definition (Cancelled star) </b>: A star of a space group is said to
be <em>cancelled</em> if the only solution to the relationships among
the coefficients of waves in the star function is the trivial solution
\f[
   c_{1} = c_{2} = \cdots = c_{M} = 0
   \quad,
\f]
for which the coefficients of all waves are zero.

The stars of a space group that are cancelled are the same as the ones
for which systematic cancellations of scattering intensities are observed
in scattering experiments.  Nonzero star functions do not exist for
cancelled stars. The Fourier series expansion of periodic functions with
a specified space group symmetry in a basis of star functions thus uses
only star functions that are associated with uncancelled stars (i.e.,
those that are not cancelled).

<em> Centered Lattices </em>:
The simplest reason for cancellation of stars in PSCF occurs in the
case of face- or body-centered lattices if one uses a conventional
Bravais lattice with orthogonal Bravais basis vectors that yield a
non-primitive conventional unit cell (e.g., simple cubic or tetragonal)
that contains two or more primitive unit cells. In these cases, the
associated space group must contain symmetry operations of the form
\f$(I, {\bf t})\f$ that simply translate the structure by a fraction
of a unit cell along each Bravais lattice direction. For example, a
a body-centered-cubic lattice can be described by a simple cubic
Bravais lattice and space group that includes a centering operation
\f$(I, {\bf t})\f$ with \f${\bf t} = (1/2, 1/2, 1/2)\f$. This sort of
description, which is used by default by PSCF, leads to cancellation
of stars of wavevectors that belong to the reciprocal lattice of the
lattice with a non-primitive unit cell (e.g., simple cubic) but that
actually do not belong to the reciprocal lattice of the centered
lattice.

<b> Definition (Unary contradiction) </b>:
Suppose \f$ {\bf G} \f$ is a wavevector in a star of space group \f$ S \f$
and \f$ A = (R, {\bf t}) \f$ is a symmetry operation in \f$ S \f$ with
\f$ {\bf t} \neq 0 \f$ that maps \f$ {\bf G} \f$ onto itself, such that
\f$ {\bf G} = {\bf G}A \f$.
The existence of such a symmetry leads to a phase relationship
\f[
   c = e^{i{\bf G}\cdot {\bf t}} c \quad.
\f]
This is said to cause <em> unary contradiction </em> for wavevector
\f$ {\bf G} \f$ if
\f[
   e^{i{\bf G}\cdot{\bf t}} \neq 1  \quad,
\f]
since in this case, the only solution to this phase relationship is the
trivial solution \f$ c = 0 \f$.

<b> Theorem D.8 (Unary contradictions infect entire stars) </b>:
If \f$ T \f$ is a star of space group \f$ S \f$ and a unary
contradiction exists for any wavevector in \f$ T \f$, then a unary
contradiction exists for every wavevector in \f$ T \f$.

<em> Proof </em>: Suppose that \f$ {\bf G} \f$ is a wavevector
in \f$ T \f$ for which there exists a symmetry operation
\f$ A = (R_{A}, {\bf t}_{A}) \f$ such that \f$ {\bf G}={\bf G}A \f$
and \f$ \exp ( i {\bf G} \cdot {\bf t}_{A} ) \neq 1 \f$, giving a
unary contradiction for \f${\bf G}\f$.
Suppose that \f$ {\bf G}' \f$ is a different wavevector in \f$ T \f$,
for which there must exist an operation
\f$ B = ( R_{B}, {\bf t}_{B} ) \f$ in \f$ S \f$ such that
\f$ {\bf G} = {\bf G}'B^{-1} \f$. There thus exists a symmetry
\f$ C = B^{-1}AB \f$ such that \f${\bf G}' = {\bf G}' C \f$ that
can be shown to lead to a phase relationship
\f$ c' = c' e^{ i{\bf G}\cdot{\bf t}_{A} } \f$ for the coefficient
\f$ c' \f$ of the wave with wavevector \f$ {\bf G}' \f$. This
implies the existence of a unary contradiction for any wavevector
\f$ {\bf G}' \in T \f$.

Cancellation of a star will also occur if there exist any pair
of wavevectors in the same star that are related by two symmetry
operation that generate contradictory phase relationships between
those wavevevectors. We refer to this as a binary contradiction.

<b> Definition (Binary contradiction) </b>:
Suppose \f$ {\bf G} \f$ and \f$ {\bf G}' \f$ are two different
wavevectors in a star of space group \f$ S \f$ that are related
by two different symmetry operations \f$ A, B \in S \f$, such that
\f[
   {\bf G}' = {\bf G}A = {\bf G}B  \quad,
\f]
where \f$ A = (R_{A}, {\bf t}_{A}) \f$ and
\f$ B = (R_{B}, {\bf t}_{B}) \f$.
The phase relationships generated by applying these symmetry 
operations to a wave with wavevector \f${\bf G}\f$ are said to 
yield a <em>binary contradiction</em> if application of \f$ A \f$ 
and \f$ B \f$ to \f${\bf G}\f$ yield unequal phase factors
\f[
   e^{i{\bf G}\cdot{\bf t}_{A}} \neq e^{i{\bf G}\cdot {\bf t}_{B}}
   \quad.
\f]
The existence of one or more such binary contradictions among the 
phase relationships associated with a star implies that the star 
is cancelled.

<b> Theorem D.9 (Binary contradictions imply unary contradictions) </b>:
If the phase relationships among the wavevectors in a star contain
one or more binary contradictions, then there also exists a unary 
contradiction for every wavevector in the star.

<em>Proof</em>:
Suppose that a star \f$ T \f$ of space group \f$ S \f$ contains two
distinct wavevectors \f$ {\bf G} \f$ and \f$ {\bf G}' \f$ and that
\f$ S \f$ contains two distinct operations
\f$ A = (R_{A}, {\bf t}_{A}) \f$ and
\f$ B = (R_{B}, {\bf t}_{B}) \f$
such that \f$ {\bf G}' = {\bf G}A = {\bf G} B \f$, and such that
\f$ e^{i{\bf G}\cdot{\bf t}_{A}} \neq e^{i{\bf G}\cdot {\bf t}_{B}} \f$,
leading to a binary contradiction.  Let \f$ C = AB^{-1} \f$ and observe
that \f$ {\bf G} = C{\bf G} \f$.
Applying \f$ C \f$ to a wave \f$ f({\bf r}) = c e^{i{\bf G}\cdot {\bf r}} \f$
generates a transformed wave
\f[
   f(A(B^{-1}({\bf r})) =
   c e^{i{\bf G}\cdot ({\bf t}_{A} - {\bf t}_{B})}
   e^{i{\bf G}\cdot {\bf r}}
   \quad,
\f]
with the same wavevector. Requiring  that
\f$ f(A(B^{-1}({\bf r})) = f({\bf r}) \f$
have equal prefactors within the expansion of a star function
generates an inconsistency if and only if
\f[
  e^{i{\bf G} \cdot ({\bf t}_{A} - {\bf t}_{B})} \neq 1 \quad.
\f]
Observe that this is equivalent to the criterion for the existence
of a pairwise contradiction involving wavevectors \f$ {\bf G} \f$
and \f$ {\bf G}' \f$. Existence of a binary contradiction for
\f${\bf G} \f$ and \f${\bf G}'\f$ thus implies the existence of a
unary contradiction for either \f${\bf G}\f$ or \f${\bf G}'\f$.
By theorem D.8, existence of a binary contradiction thus implies
the existence of a unary contradiction for every wavevector in
the star.

The algorithm used by PSCF to identify cancelled stars tests for
the existence of unary contradictions for any wave in the star.

\subsection prdc_basis_noncancel_sub Uncancelled stars

\anchor prdc_basis_starfunc_dimension_thrm
<b> Theorem D.10 (Dimension of the system of phase relationships) </b>:
If \f$ T \f$ is a star of space group \f$ S \f$ that contains \f$ M \f$
wavevectors, and the phase relationships among wavevectors in \f$ T \f$
do not contain any unary contradictions, than the star is not cancelled,
and phase relationships among wavevectors in \f$ T \f$ form a homogeneous
system of \f$ M - 1 \f$ independent linear equations for the coefficients
of waves in an associated star function.  A full set of independent
phase relationships is provided by the phase relationships between any
one wavevector in \f$ T \f$ and the other \f$ M - 1 \f$ wavevectors in
\f$ T \f$.

<em> Proof </em>: The assumption that there are no unary contradictions
among the phase relationships between wavevectors in \f$ T \f$ implies
that there are also no binary contradictions, by Theorem D.9.
Let \f$ {\bf G}_{0}, {\bf G}_{1}, \ldots, {\bf G}_{M-1} \f$ denote the
wavevectors in \f$ T \f$, listed in some arbitrarily chosen order. Let
\f$ c_{i} \f$ denote the coefficient of the wave with wavevector
\f$ {\bf G}_{i} \f$ in the definition of an associated star function.
For each \f$ j = 1, \ldots, M-1 \f$, there must exist a symmetry
operation \f$ A_{j} = (R_{j}, {\bf t}_{j}) \f$ such that
\f[
   {\bf G}_{j} = {\bf G}_{0} A_{j}  \quad.
\f]
If the number of symmetry operations in \f$ S \f$ is greater than
\f$ M \f$, then there may exist two or more symmetry operations that
generate the same wavevector \f$ {\bf G}_{j} \f$ when applied to
\f$ {\bf G}_{0} \f$. If so, we may define \f$ {\bf A}_{j} \f$ to be any
one of these operations, and the assumption that there are no binary
contradictions implies that different choices will lead to equivalent
phase relationships. The phase relationships between \f$ {\bf G}_{0} \f$
and the other vectors in \f$ T \f$ gives a set of \f$ M - 1 \f$
independent linear homogeneous equations for the coefficients, each
of which is an equation of the form
\f[
   c_{j} = c_{0}e^{i{\bf G}_{0}\cdot{\bf t}_{j}}
\f]
for some \f$ i > 0 \f$. Suppose that \f$ {\bf G}_{j} \f$ and
\f$ {\bf G}_{k} \f$ are two wavevectors in \f$ T \f$, with
\f$ j \neq 0 \f$ and \f$ k \neq 0 \f$. We may identify a symmetry
relationship between these two vectors by noting that
\f[
   {\bf G}_{k} = {\bf G}_{j} A^{-1}_{j}A_{k} \quad.
\f]
This symmetry relationship yields a corresponding phase relationship
\f[
    c_{k} = c_{j} e^{-i{\bf G}_{0}\cdot {\bf t}_{j}}
                  e^{i{\bf G}_{0}\cdot {\bf t}_{k}}
          = c_{0} e^{i{\bf G}_{0}\cdot {\bf t}_{k}}
\f]
that is equivalent to a combination of the phase relationships between
\f${\bf G}_{0}\f$ and \f${\bf G}_{j}\f$ and \f${\bf G}_{k} \f$.
Expanding the system of \f$M-1\f$ binary phase relationships that
involve the coefficient \f$ c_{0} \f$ by adding additional phase
relationships that do not involve \f$ c_{0} \f$ is thus found to
leave the dimension or rank of the system of equations unchanged.
In a star with no unary or binary contradictions, the set of all
phase relationships thus forms a system of exactly \f$ M - 1\f$
independent homogeneous linear equations for \f$ M \f$ coefficients.
The resulting system of equations always has a non-empty set of
nontrivial solutions, and is thus not cancelled.

\anchor prdc_basis_starfunc_uniqueness_thrm
<b> Theorem D.11 (Uniqueness of star functions to within a constant) </b>:
If two functions \f$ f({\bf r}) \f$ and \f$ g({\bf r}) \f$ are both
nonzero star functions associated with a single star \f$ T \f$ of
a space group \f$ S \f$, then
\f[
   g({\bf r}) = c f({\bf r})
\f]
for some nonzero complex constant \f$ c \f$.

<em> Proof </em>: Consider a star \f$ T \f$ with \f$ M \f$ distinct
wavevectors \f$ {\bf G}_{1}, \ldots, {\bf G}_{M}  \f$. By theorem D.10,
the phase relationships of an an uncancelled star form a system of
\f$ M -1 \f$ homogeneous equations for \f$ M \f$ unknown coefficients.
The set of solutions for the resulting set of equations is thus a vector
space with dimension 1. This corresponds to a set of solutions that
can all be expressed as \f$ c f({\bf r}) \f$, in which \f$ c \f$ is a
complex constant and \f$ f({\bf r}) \f$ is any single nonzero solution.

\section prdc_basis_closed_sec Closed stars

<b> Definition (Closed Stars) </b>: A set of wavevectors \f$ T \f$
is <em>closed</em> under inversion if, for every wavevector
\f$ {\bf G} \in T \f$, \f$ -{\bf G} \in T\f$.

The following theorem simplifies the treatment of closed stars:

\anchor prdc_basis_closed_real_thrm
<b> Theorem D.12 (Closed stars yield real star functions) </b>:
If \f$ \phi({\bf r}) \f$ is a star function associated with a star
that is closed under inversion, then there exists a complex constant
\f$ c \f$ for which \f$ c \phi({\bf r}) \f$ is a real-valued function
of position \f$ {\bf r} \f$.

<em> Proof </em>: Suppose that \f$ \phi({\bf r}) \f$ is a nonzero
star function associated with a star \f$ T \f$, and is thus invariant
under the space group \f$ S \f$ used to define the star. Let
\f$ \phi({\bf r}) = u({\bf r}) + iv({\bf r}) \f$ where \f$ u \f$ and
\f$ v \f$ are real functions that represent real and imaginary parts.
Observe that \f$ u \f$ and \f$ v \f$ must also be invariant under
\f$ S \f$. Consider the cases in which one or the other of these
real functions is zero, or in which they are both nonzero.
If \f$ u({\bf r}) \neq 0 \f$ and \f$ v({\bf r}) = 0 \f$, then
\f$ \phi({\bf r}) \f$ is real, and \f$ c \f$ can be any real number.
If \f$ u({\bf r}) = 0 \f$ and \f$ v({\bf r}) \neq 0 \f$, then
\f$ -i\phi({\bf r}) \f$ is real, and \f$ c \f$ can be any pure
imaginary number.
If \f$ u({\bf r}) \neq 0 \f$ and \f$ v({\bf r}) \neq 0\f$, then
\f$ u \f$ and \f$ v \f$ are two functions that are superpositions of
waves in star \f$ T \f$ and symmetric under space group \f$ S \f$.
Because the set of such functions is a vector space of dimension 1
(see \ref prdc_basis_starfunc_uniqueness_thrm "Theorem D.11" above),
this implies that there exists a real constant \f$ d \f$ such that
\f$ v({\bf r}) = d u({\bf r}) \f$ for all \f$ {\bf r} \f$, giving
\f$ \phi({\bf r}) = (1+id)u({\bf r}) \f$. In this case
\f$ \phi({\bf r})/(1+id) \f$ is real, giving \f$ c \propto 1/(1+id)\f$.

\section prdc_basis_open_sec Open stars

<b> Definition (Open sets of wavevectors) </b>: A set of wavevectors
\f$ T \f$ is <em>open</em> under inversion if, for every wavevector
\f$ {\bf G} \in T\f$, \f$ -{\bf G} \notin T \f$.

Note that this definition does <em> not </em> define a set of wavevectors
to be open under inversion if and only if it is not closed. The above
definition is more restrictive: A set \f$ T \f$ is open only if, for
<em> every </em> wavevector \f$ {\bf G} \in T\f$, \f$ -{\bf G} \notin T\f$.
A set of wavevectors can thus be neither open nor closed if it
contains a non-empty subset of wavevectors for which the inverse is also
in the set, and another non-empty subset for which the inverse of each
wavevector is not in the set.  It turns out, however, that this
hypothetical intermediate case cannot occur for a star of a space
group.

<b> Theorem D.13 (Stars are either open or closed) </b>:
Every star of a space group must be either open or closed.

<em> Proof </em>: First consider the special cases of stars with only
one or two wavevectors.  If a star \f$ T \f$ contains only one
wavevector \f$ {\bf G} \f$, then \f$ T \f$ is closed under inversion if
\f$ {\bf G} = 0 \f$ and open under inversion if \f$ {\bf G} \neq 0 \f$.
If a star \f$ T \f$ contains exactly two wavevectors,
\f$ T = \{ {\bf G}, {\bf G}' \} \f$, then both wavevectors must be
nonzero vectors of equal magnitude, and \f$ T \f$ is closed under
inversion if \f$ {\bf G}' = -{\bf G} \f$ and open otherwise. Now
consider the case of a star that contains three or more nonzero
wavevectors.  Suppose that a star \f$ T \f$ of space group \f$ S \f$
contains three or more nonzero wavevectors, and that \f$ T \f$ is not 
open, so that there exists at least one wavevector \f$ {\bf G} \in T \f$ 
for which \f$ -{\bf G} \in T \f$.  Let \f$ {\bf G}' \f$ be any other
wavevector in \f$ T \f$, for which \f$ {\bf G}' \neq {\bf G} \f$ and
\f$ {\bf G}' \neq -{\bf G} \f$. There must exist a symmetry operation
\f$ A = (R, {\bf t}) \f$ in \f$ S \f$ such that
\f$ {\bf G}' = R^{\dagger}{\bf G} \f$ (where \f$ R^{\dagger} \f$ is the 
\ref prdc_symmetry_adjoint_def_eqn "adjoint" of \f$ R \f$ and 
\f$ {\bf G}A = R^{\dagger}{\bf G} \f$). 
Closure of the star under symmetry operations then implies that
\f$ - {\bf G}' \f$ is also in \f$ T \f$, because
\f$ -{\bf G}' = R^{\dagger}(-{\bf G}) \f$. This implies that a star
that is not open must be closed, completing the proof.

<b> Definition (Inverse of a set of wavevectors) </b>:
If \f$ T = \{ {\bf G}_{1}, \ldots , {\bf G}_{M} \} \f$ is a set of
wavevectors, then \f$ \{ -{\bf G}_{1}, \ldots , - {\bf G}_{M} \} \f$
is known as the inverse of \f$ T \f$. If a star is open, then it has
no intersection with its inverse. If a star is closed, it is equal
to its own inverse.

<b> Theorem D.14 (The inverse of an open star is also a star) </b>:
If \f$ T \f$ is an open star of wavevectors for space group \f$ S \f$,
then the inverse of \f$ T \f$ is also a star of \f$ S \f$.

<em> Proof </em>:
We first prove closure of the inverse of \f$ T \f$ under \f$ S \f$:
For each vector \f$ -{\bf G} \f$ in the inverse of \f$ T \f$ and each
space group operation \f$ A = (R, {\bf t}) \f$ in \f$ S \f$, the
vector \f$ (-{\bf G})A = -({\bf G}A) \f$ is also in the inverse of
\f$ T \f$, proving closure.

We next prove connectivity: Suppose \f$ {\bf G} \f$ and \f$ {\bf G}' \f$
are both nonzero wavevectors that belong an open star \f$ T \f$ of space
group \f$ S \f$, for which there must exist a symmetry operation
\f$ A = ( R, {\bf t}) \f$ in \f$ S \f$ such that
\f$ {\bf G}' = R^{\dagger}{\bf G} \f$. This also implies that
\f$ -{\bf G}' = -{\bf G}A \f$, thus implying that any two vectors
\f$-{\bf G}\f$ and \f$-{\bf G}'\f$ in the inverse of \f$ T \f$ are
related by a space
group symmetry.

<b> Theorem D.15 (Star functions for open stars) </b>:
If \f$ \phi({\bf r}) \f$ is a star function of space group
\f$ S \f$ that is associated with an open star \f$ T \f$, then the
complex conjugate \f$ \phi^{*}({\bf r}) \f$ is a star function
associated with the inverse of \f$ T \f$.

<em> Proof </em>:
Suppose that \f$ T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \f$
is a non-cancelled open star of space group \f$ S \f$ that contains
\f$ M \f$ wavevector.
Suppose that \f$ \phi({\bf r}) \f$ is an associated star function,
given by a superposition
\f[
   \phi({\bf r}) = \sum_{j=0}^{M} c_{j} e^{i{\bf G}_{j}\cdot{\bf r}}
   \quad.
\f]
The complex conjugate \f$ \phi^{*}({\bf r}) \f$ is given by a sum
\f[
   \phi^{*}({\bf r}) = \sum_{j=0}^{M} c_{j}^{*} e^{-i{\bf G}_{j}\cdot{\bf r}}
   \quad,
\f]
which is a superposition of waves with wavevectors that belong to a
set \f$ T' = \{ -{\bf G}_{0}, \ldots, -{\bf G}_{M-1} \} \f$ that is
the inverse of \f$ T \f$.
Because \f$ \phi({\bf r}) \f$ is invariant under group \f$ S \f$, so
is \f$ \phi^{*}({\bf r}) \f$, by
\ref prdc_symmetry_symmfunc_conj_thrm "Theorem C.5".
This implies that \f$ \phi^{*}({\bf r}) \f$ is a star function
associated with \f$ T '\f$, the inverse of star \f$ T \f$.

\section prdc_basis_centro_sec Centrosymmetric groups
\anchor prdc_basis_centro_def
<b> Definition (Centrosymmetric groups) </b>: A space group is
centro-symmetric if it contains an operation that represents inversion
through some inversion center. Inversion through an inversion center
located at position \f$ {\bf c} \f$ is given explicitly by
\f[
   i = (-I, 2 {\bf c})
\f]
for which
\f[
   i({\bf r}) = -{\bf r} + 2{\bf c} \quad,
\f]
and for which \f$ i({\bf c}) = {\bf c} \f$.

The following theorem allows a particularly simple treatment of star
functions of centro-symmetric groups:

\anchor prdc_basis_centro_closed_thrm
<b> Theorem D.16 (Stars of centrosymmetric groups) </b>: All stars of 
a centro-symmetric group are closed under inversion.

<em>Proof</em>: An inversion operation \f$ i = (-I, 2{\bf c}) \f$
with inversion center \f$ {\bf c} \f$ transforms every wavevector
\f$ {\bf G} \f$ in a star into its inverse
\f[
  {\bf G}i = -I{\bf G} = -{\bf G} \quad,
\f]
where we have used the fact that \f$ (-I)^{\dagger} = -I \f$.
This implies that, for any centrosymmetric group, if a wavevector
\f$ {\bf G} \f$ is in a star, then \f$ -{\bf G} \f$ is in the same
star, and thus that every star must be closed under inversion.
By \ref prdc_basis_closed_real_thrm "Theorem D.12", this implies
that a real star function can be defined for every star of any
centro-symmetric group.

\anchor prdc_basis_centro_origin_thrm
<b> Theorem D.17 (Star functions of groups with  an inversion center at the origin) </b>: 
If a group \f$ S \f$ has an inversion center at the origin of space, then 
it is possible to define a star function for every star of \f$ S \f$ in 
which the coefficients of all waves are real, and in which coefficients of 
waves with wavevectors \f${\bf G}\f$ and \f$-{\bf G}\f$ are equal.

<em>Proof</em>: If the group has an inversion center at the origin, it 
has a symmetry operation \f$ i = (-I,0) \f$ that relates an vector 
\f${\bf G}\f$ to \f$-{\bf G} = {\bf G}i\f$. The associated phase 
relationship requires that the coefficients of the two associated waves 
must be equal. By Theorem D.16, it is always possible to define a real 
star function associated with every star of such a group, in which 
coefficients of waves with wavevectors \f${\bf G}\f$ and \f$-{\bf G}\f$ 
must be complex conjugates. A pair of coefficients that are both equal 
and complex conjugates must both be real.

Comment: The conclusion that coefficients of all waves can be chosen
to be real for star functions of groups that have an inversion center
at the origin does not mean that the the coefficients of different 
waves within a star are necessarily all of the same sign, or that 
they can thus all be chosen to be equal positive numbers. In a group 
that has an inversion center at the origin but that also contains 
contain non-symmorphic glide plane or screw axis symmetries, it possible 
for phase relationships arising from these other symmetry operations to 
require coefficients of different waves within the same star to be 
of opposite sign. This occurs, for example, in star functions of the 
space group \f$ Ia\overline{3}d\f$ of the double gyroid phase. 

Comment: The simplest case is that of a symmorphic group with an 
inversion center at the origin, such as the \f$ I m\overline{3}m \f$ 
space group of a BCC crystal. (Recall: The symmetry operations of a
symmorphic group are all point group operations, without any nonzero
translations). In this special case, all stars are closed, and 
coefficients of all waves in each star must all have equal values 
that can all be chosen to be positive by convention.

<BR>
\ref prdc_symmetry_page  (Prev) &nbsp; &nbsp; &nbsp; &nbsp;
\ref prdc_page           (Up) &nbsp; &nbsp; &nbsp; &nbsp;
\ref developer_page      (Next)

*/
